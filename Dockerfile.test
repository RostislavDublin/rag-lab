FROM python:3.11-slim

WORKDIR /app

# Install only uvicorn
RUN pip install uvicorn fastapi

# Create minimal src package
RUN mkdir -p src
RUN echo "# Test package" > src/__init__.py

# Create minimal main.py
RUN echo 'from fastapi import FastAPI\n\
app = FastAPI()\n\
\n\
@app.get("/health")\n\
def health():\n\
    return {"status": "ok"}' > src/main.py

# Test that we can import
RUN python -c "import src.main; print('SUCCESS: Module imported!')"

ENV PYTHONPATH=/app

CMD ["python", "-m", "uvicorn", "src.main:app", "--host", "0.0.0.0", "--port", "8080"]
